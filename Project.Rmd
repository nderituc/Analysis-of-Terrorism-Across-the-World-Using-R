---
title: "Analysis of Terrorism Fatalities Across the World"
author: "Sharon and Catherine"
date: '2022-04-14'
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



This project seeks to understand how terrorism has impacted the world.

To accomplish this project, the following questions will be used;
1. Which region has highly been affected by terrorism?
2. Has global terrorism, in the top 5 most affected countries, reduced or increased over the years (2000-2017)?
3. Which region has highly been affected by terrorism?
4. What’s the happiness index and GDP of the country highly affected by terrorism? Compare

## Load Packages and Import Data
The chunk below contains the packages that will be needed for this project.

```{r Load Packages, message=FALSE}
#Load necessary packages
library(tidyverse) #For performing data transformation
library(ggplot2) #For creating charts
library(readr) #For importing data
library(dplyr) #For performing data transformation
```

```{r Import Data, message = FALSE}
#Import dataset containing terrorism fatalities
terrorism_fatalities <- readr::read_csv("fatalities-from-terrorism.csv", show_col_types = FALSE)
```

```{r Display Dataset}
#Display the first five rows of the imported dataset
as_tibble(terrorism_fatalities)
head(terrorism_fatalities)
```

##Data Transformation

Check for the number of rows and columns
```{r Rows}
#Number of rows
nrow(terrorism_fatalities)
```

```{r Columns}
#Number of columns
ncol(terrorism_fatalities)
```


```{r Missing Values}
#Check for missing values
#sum(is.na(terrorism_fatalities))

colSums(is.na(terrorism_fatalities))
```

The terrorism fatalities dataset has no missing values.

Check for unique values in the 'Entity' column.
```{r}
#Unique values in the dataset
unique(terrorism_fatalities[c("Entity")])
```

Rename 'Entity' column to 'Country'.
```{r Rename}
terrorism_fatalities <- terrorism_fatalities %>%
  rename(Country = Entity)
```

Summary statistics
```{r Summary}
summary_stat <- terrorism_fatalities %>% 
  group_by(Country) %>%
  summarise(
    count = n(), #Number of rows 
    avg = mean(Fatalities), 
    minimum = min(Fatalities),
    maximum = max(Fatalities)
  ) %>% 
  arrange()
summary_stat

```


Since our dataset is tidy, we will go ahead and analyse our data based on our research questions.
###1. Which region has highly been affected by terrorism?

Reorder the dataset to check which country has had the highest number of fatalities as a result of terrorism

```{r Arrange}
highest <- terrorism_fatalities %>% 
  group_by(Country) %>%
  summarise(maximum = max(Fatalities)) %>% 
  arrange(desc(maximum)) #Ordering the values from the highest to the lowest

highest
```

From the tibble above, we can see that Iraq has had the highest number of fatalities resulting from terrorism, followed by Nigeria then Afghanistan.
```{r}
lowest <- highest %>% 
  filter(maximum < 1)

lowest
```
The countries in the tibble above have had the least/no fatalities resulting from terrorism. This implies that these countries have had least/no terrorism attacks.

###2. Has global terrorism, in the top 5 most affected countries, reduced or increased over the years (2000-2017)? 

Find the top five countries affected by terrorism.
```{r}
highest_terrorism <- highest %>% 
  filter(maximum >= 3924)

highest_terrorism
```



```{r Merge dataset}
terrorism_high <- highest_terrorism %>%
  left_join(terrorism_fatalities, by = "Country")

terrorism_high
```


```{r Geom_line, echo=FALSE}
plot_data <- terrorism_high %>% 
  filter(Year >= 2000)

ggplot(terrorism_high, aes(x = Year, y = Fatalities, group=Country, color=Country)) + 
  geom_line()+
  ggtitle("Terrorism Fatalities of the Top Five Most Affected Countries 
          Between (2000-2017)") +
  xlab("Year") + 
  ylab("Number of Fatalities")

```

###3. Which countries have the highest life satisfaction? What's their GDP?
```{r}
#Import dataset containing life satisfaction and gdp of countries
gdp_happiness <- readr::read_csv("gdp-vs-life-satisfaction.csv", show_col_types = FALSE)

gdp_happiness 
```

Join 'gdp_happiness' dataset with 'terrorism_fatalities' dataset
```{r}
merged_data <- gdp_happiness %>% 
  full_join(terrorism_fatalities, by = "Country")

merged_data
```

Compute the average life satisfaction, fatalities and GDP of each country
```{r}
average_data <- merged_data %>% 
  group_by(Country) %>% 
  summarise(
    average_satisfaction = mean(Life_Satisfaction, na.rm=TRUE),
    average_gdp = mean(GDP, na.rm=TRUE),
    average_fatalities = mean(Fatalities, na.rm=TRUE))

average_data
```

Which countries have the highest life satisfaction?

```{r}
high_to_low <- average_data %>% 
  select(Country, average_satisfaction) %>%
  arrange(desc(average_satisfaction)) #Ordering the values from the highest to the lowest

high_to_low
```

Denmark has the highest life satisfaction then Norway and Switzerland.

###4. What’s the life satisfaction of the regions highly affected by terrorism? Do the regions highly affected by terrorism have high life satisfaction and GDP or low?

```{r}

joined_data <- highest_terrorism %>% 
  left_join(merged_data, by = "Country")

joined_data
```


```{r}
comparison_data <- joined_data %>%
  group_by(Country) %>% 
  summarise(
    avg_satisfaction = mean(Life_Satisfaction, na.rm = TRUE),
    avg_fatalities = mean(Fatalities, na.rm = TRUE),
    avg_gdp = mean(GDP, na.rm = TRUE))
comparison_data
```

```{r Geom_bar}
#import library gridExtra to help in joining the plots
library(gridExtra)

fatalities_plot <- comparison_data %>% 
  ggplot(mapping = aes(x = avg_fatalities, y = Country))+
  geom_bar(stat="identity", width=1, color="white",
         fill=rgb(0.8,0.4,0.1,0.7))+
  xlab("Number of Fatalities")

satisfaction_plot <- comparison_data %>% 
  ggplot(mapping = aes(x = avg_satisfaction, y = Country))+
  geom_bar(stat="identity", width=1, color="white",
         fill=rgb(0.1,0.8,0.1,0.7))+
  xlab("Life Satisfaction")
 
gdp_plot <- comparison_data %>% 
  ggplot(mapping = aes(x = avg_gdp, y = Country))+
  geom_bar(stat="identity", width=1, color="white",
         fill=rgb(0.1,0.4,0.5,0.7))+
  xlab("GDP Per Capita")
 
# Use grid.arrange to put plots in columns
grid.arrange(fatalities_plot,satisfaction_plot,gdp_plot, nrow = 3, 
             top = "Comparison of Life Satisfaction and GDP of Countries 
             Highly Affected by Terrorism")
```


###4. How do terrorism fatalities compare across countries in the world?



Compute the average terrorism rate for each country
```{r}
#Group by Country and find the terrorism rate for each country
terrorism_fatalities <- terrorism_fatalities %>% 
  group_by(Country) %>% 
  summarise(Fatalities=mean(Fatalities))
```

Rename 'Country' column to 'region'.
```{r}
terrorism_fatalities <- terrorism_fatalities %>%
  rename(region = Country)
```

Plot a choropleth map to show how terrorism compare across countries.
```{r Choropleth Map}
#Convert from tibble to dataframe
terrorism_fatalities <- as.data.frame(terrorism_fatalities)

#Data containing longitudes and latitudes to be used in mapping the data
global_map <- map_data("world")

#Merge the "world" map_data to the terrorism_fatalities dataset
merged_data <- left_join(global_map, terrorism_fatalities, by = "region")

#Plot the map
ggplot(merged_data, aes(long, lat, label = region ,group = group))+
  geom_polygon(aes(fill = Fatalities), color = "white")+
  ggtitle("Fatalities Resulting From Terrorism Activities Across the World")+
  scale_fill_viridis_c(option = "C")+
  theme(#panel.background = element_rect(fill = "white"),
        #plot.background = element_rect(fill = "white"),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.ticks = element_blank(),
        #rect = element_blank(),
        #panel.border =  element_blank(),
        legend.title= element_text(
          hjust = 0.4 ,vjust=0.3, size=10,family = "Times"),
        legend.text = element_text(
          hjust = 0.4 ,vjust=2, size=8,family = "Times"))
  

```





